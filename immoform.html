<html><head>
<meta charset="UTF-8">
<meta name="viewport" price="width=device-width, initial-scale=1.0">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
<style>
body, html {
    margin: 0;
    padding: 0;
    font-family: 'Inter Tight', sans-serif;
    background: linear-gradient(135deg, #0D0D2B, #1C1C34);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow-x: hidden;
}

.form-container {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    padding: 40px;
    width: 100%;
    max-width: 600px;
    margin: 20px;
    box-sizing: border-box;
    position: relative;
    overflow: hidden;
}

.form-container::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
    transform: rotate(30deg);
    pointer-events: none;
}

h1 {
    color: #FFFFFF;
    font-size: 36px;
    text-align: center;
    margin-bottom: 30px;
    font-weight: bold;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    position: relative;
}

h1::after {
    content: attr(data-text);
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    filter: blur(3px);
    opacity: 0.7;
    z-index: -1;
}

form {
    display: flex;
    flex-direction: column;
}

label {
    color: #FFFFFF;
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 10px;
}

input[type="text"],
input[type="date"],
textarea {
    width: 100%;
    padding: 12px;
    margin-bottom: 20px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 8px;
    font-size: 16px;
    color: #333333;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(5px);
    transition: all 0.3s ease;
}

input[type="text"]:focus,
input[type="date"]:focus,
textarea:focus {
    border-color: #5F63F2;
    box-shadow: 0 0 0 2px rgba(95, 99, 242, 0.2);
    outline: none;
}

textarea {
    height: 150px;
    resize: vertical;
}

.file-upload {
    border: 2px dashed rgba(255, 255, 255, 0.2);
    border-radius: 8px;
    padding: 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: 20px;
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(5px);
}

.file-upload:hover {
    border-color: #5F63F2;
    background: rgba(255, 255, 255, 0.1);
}

.file-upload p {
    color: #C4C4C4;
    margin: 0;
}

input[type="file"] {
    display: none;
}

.submit {
    background-color: #5F63F2;
    color: #FFFFFF;
    border: none;
    padding: 14px 24px;
    font-size: 18px;
    font-weight: bold;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    align-self: center;
    position: relative;
    overflow: hidden;
}

.submit::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0) 70%);
    transform: rotate(30deg);
    transition: all 0.5s ease;
    opacity: 0;
}

.submit:hover {
    background-color: #4A4DC7;
    transform: scale(1.05);
}

.submit:hover::before {
    opacity: 1;
    transform: rotate(30deg) translate(20%, -20%);
}

.error-message {
    color: #FF6B6B;
    font-size: 14px;
    margin-top: -15px;
    margin-bottom: 15px;
    display: none;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.shape {
    position: absolute;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(15px);
    border-radius: 50%;
    z-index: -1;
}

.circle1 {
    width: 100px;
    height: 100px;
    top: -50px;
    left: -50px;
}

.circle2 {
    width: 150px;
    height: 150px;
    bottom: -75px;
    right: -75px;
}

.triangle {
    width: 0;
    height: 0;
    border-left: 75px solid transparent;
    border-right: 75px solid transparent;
    border-bottom: 130px solid rgba(255, 255, 255, 0.1);
    position: absolute;
    top: 50%;
    left: -100px;
    transform: translateY(-50%) rotate(30deg);
    filter: blur(15px);
}

@keyframes ripple {
    0% {
        transform: scale(1);
        opacity: 1;
    }
    100% {
        transform: scale(1.5);
        opacity: 0;
    }
}

.ripple {
    position: absolute;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.4);
    transform: scale(0);
    animation: ripple 0.6s linear;
    pointer-events: none;
}

@media (max-width: 1199px) {
    .form-container {
        width: 80%;
        padding: 30px;
    }

    input[type="text"],
    input[type="date"],
    textarea {
        padding: 10px;
    }
}

@media (max-width: 767px) {
    .form-container {
        width: 100%;
        padding: 20px;
        margin: 10px;
    }

    h1 {
        font-size: 28px;
    }

    label {
        font-size: 16px;
    }

    input[type="text"],
    input[type="date"],
    textarea,
    .submit {
        font-size: 16px;
        padding: 12px;
    }

    .submit {
        width: 100%;
        height: 44px;
    }

    .error-message {
        margin-bottom: 20px;
    }
}

</style>
</head>
<body>
    <div class="form-container">
        <div class="shape circle1"></div>
        <div class="shape circle2"></div>
        <div class="triangle"></div>
        <h1 data-text="Submit a Blog Post">Immo post</h1>
        <form id="blogPostForm">
            <label for="photo">Photo</label>
            <div class="file-upload" id="photoUpload">
                <p>Click to upload or drag and drop your photo here</p>
                <input type="file" id="photo" name="photo" accept="image/*" required onchange="handleChangePhoto(event)">
            </div>
            <div class="error-message" id="photoError">Please upload a photo</div>

            <label for="description">Title</label>
            <input type="text" id="description" name="description" required onchange="handleChangetitle(event)">
            <div class="error-message" id="titleError">This field is required</div>

            <label for="description">Description</label>
            <textarea id="description" name="description" required onchange="handleChangedescription(event)"></textarea>
            <div class="error-message" id="descriptionError">This field is required</div>

            <label for="price">Price</label>
            <input type="text" id="price" name="price" required onchange="handleChangeprice(event)">
            <div class="error-message" id="priceError">Please enter a valid price</div>

            <button type="button" class="submit" onclick="sendData()">Submit</button>
        </form>
    </div>

    <script>
        const dataArray = {
    photo: null,   // par défaut null
    title: '',      // une chaîne vide
    description: '',     // une chaîne vide
    price: ''
};

const handleChangePhoto = (e) => {
    dataArray.photo = e.target.files[0];
    console.log(dataArray.photo);
};

const handleChangetitle = (e) => {
    dataArray.title = e.target.value;
    console.log(dataArray.title);
};

const handleChangedescription = (e) => {
    dataArray.description = e.target.value;
    console.log(dataArray.description);
};

const handleChangeprice = (e) => {
    dataArray.price = e.target.value;
    console.log(dataArray.price);
};

const sendData = async () => {
    try {
        const formData = new FormData();
        formData.append("photo", dataArray.photo);
        formData.append("title", dataArray.title);
        formData.append("description", dataArray.description);
        formData.append("price", dataArray.price);

        const response = await fetch(`http://localhost:3000/immo/Add`, {
            method: "POST",
            body: formData,
        });

        if (!response.ok) {
            throw new Error("Erreur lors de la requête");
        }

        const data = await response.json();
        console.log(data);
        console.log("article de vente ajouté avec succès");
        alert("article de vente ajouté avec succès");

        // Réinitialiser les champs
        dataArray.photo = null;
        dataArray.title = '';
        dataArray.description = '';
        dataArray.price = '';

        // Réinitialiser le champ de fichier (en manipulant le DOM directement)
        document.getElementById('imageUpload').value = null;
    } catch (error) {
        console.error("Erreur lors de la requête :", error);
    }
};

    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('blogPostForm');
        const fileUpload = document.getElementById('photoUpload');
        const fileInput = document.getElementById('photo');

        function createRipple(event) {
            const button = event.currentTarget;
            const ripple = document.createElement('span');
            const rect = button.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = event.clientX - rect.left - size / 2;
            const y = event.clientY - rect.top - size / 2;
            
            ripple.style.width = ripple.style.height = `${size}px`;
            ripple.style.left = `${x}px`;
            ripple.style.top = `${y}px`;
            ripple.classList.add('ripple');

            button.appendChild(ripple);

            ripple.addEventListener('animationend', () => {
                ripple.remove();
            });
        }

        const interactiveElements = document.querySelectorAll('input, textarea, button, .file-upload');
        interactiveElements.forEach(element => {
            element.addEventListener('click', createRipple);
        });

        fileUpload.addEventListener('click', () => fileInput.click());

        fileUpload.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUpload.style.borderColor = '#5F63F2';
            fileUpload.style.background = 'rgba(255, 255, 255, 0.2)';
        });

        fileUpload.addEventListener('dragleave', () => {
            fileUpload.style.borderColor = 'rgba(255, 255, 255, 0.2)';
            fileUpload.style.background = 'rgba(255, 255, 255, 0.05)';
        });

        fileUpload.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUpload.style.borderColor = 'rgba(255, 255, 255, 0.2)';
            fileUpload.style.background = 'rgba(255, 255, 255, 0.05)';
            if (e.dataTransfer.files.length) {
                fileInput.files = e.dataTransfer.files;
                updateFileName(e.dataTransfer.files[0].name);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (fileInput.files.length) {
                updateFileName(fileInput.files[0].name);
            }
        });

        function updateFileName(fileName) {
            const fileNameDisplay = fileUpload.querySelector('p');
            fileNameDisplay.textContent = `Selected file: ${fileName}`;
        }


        function validateForm() {
            let isValid = true;
            const fields = ['photo', 'description', 'description', 'price'];

            fields.forEach(field => {
                const input = document.getElementById(field);
                const error = document.getElementById(`${field}Error`);

                if (field === 'photo' && !input.files.length) {
                    isValid = false;
                    fileUpload.style.borderColor = '#FF6B6B';
                    error.style.display = 'block';
                    error.style.opacity = '1';
                } else if (field === 'price' && (isNaN(input.value) || input.value < 0)) {
                    isValid = false;
                    input.style.borderColor = '#FF6B6B';
                    error.style.display = 'block';
                    error.style.opacity = '1';
                } else if (!input.value) {
                    isValid = false;
                    input.style.borderColor = '#FF6B6B';
                    error.style.display = 'block';
                    error.style.opacity = '1';
                } else {
                    if (field === 'photo') {
                        fileUpload.style.borderColor = 'rgba(255, 255, 255, 0.2)';
                    } else {
                        input.style.borderColor = 'rgba(255, 255, 255, 0.2)';
                    }
                    error.style.display = 'none';
                    error.style.opacity = '0';
                }
            });

            return isValid;
        }
    });
    </script>
</body>
</html>